{% extends 'cars/base.html' %}
{% load static %}

{% block title %}
    <title>{{ title }}</title>
{% endblock %}

{% block css %}
    <link rel="stylesheet" href='{% static "css/car.css" %}' />
{% endblock %}

{% block context %}
<section class="car-details-section">
    <div class="car-details-container">
        {% comment %} <div class="car-image">
            <img src="{{ car.image.url }}" alt="{{ car.model }}">
        </div> {% endcomment %}
        <div class="slider">
            <div class="slides">
                {% for image in car_images %}
                <div class="slide">
                    <img src="{{ image.image.url }}" alt="{{ car.model }}">
                </div>
                {% endfor %}
            </div>
            <div class="navigation">
                <button class="prev" onclick="moveSlides(-1)">&#10094;</button>
                <button class="next" onclick="moveSlides(1)">&#10095;</button>
            </div>
        </div>

    </div>
    <div class="car-info">
            <h1>{{ car.brand.name }} {{ car.model }}</h1>
            <p>{{ car.description }}</p>
            <p><strong>Год выпуска:</strong> {{ car.year }}</p>
            <p><strong>Цена за день:</strong> {{ car.price }} руб</p>
            <p><strong>Доступно автомобилей:</strong> {{ car.quantity }}</p>

            <!-- Форма для выбора аренды -->
            <form method="POST" class="rental-form">
                {% csrf_token %}
                <label for="{{ form.start_date.id_for_label}}">Дата начала</label>
                {{ form.start_date }}
                <label for="{{ form.end_date.id_for_label}}">Дата окончания</label>
                {{ form.end_date }}
                <label for="{{ form.quantity.id_for_label}}">Количество</label>
                {% comment %} {{ form.quantity }} {% endcomment %}
                <input type="number" name="quantity" id="quantity"
                        value="{% if car.quantity > 0 %}1{% else %}0{% endif %}"
                        min="1" max="{{ car.quantity }}"
                        {% if car.quantity == 0 %}disabled{% endif %}>
                <button type="submit" class="auth-btn" {% if car.quantity == 0 %} disabled {% endif %}>Забронировать</button>
            </form>
        </div>
</section>

<script>
    let currentSlide = 0;

    function moveSlides(direction) {
        const slides = document.querySelector('.slides');
        const totalSlides = slides.children.length;
        currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
        const offset = currentSlide * -100;
        slides.style.transform = `translateX(${offset}%)`;
    }
</script>
{% endblock %}